<!doctype html>
<html lang="vi">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ (settings.site_name if settings else 'Site') if settings is defined else 'Site' }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
    <style>
         :root {
            --primary: {
                {
                    settings.primary_color if settings else '#6f42c1'
                }
            }
            ;
        }
    </style>
</head>

<body class="bg-dark text-light">
    <div class="cskh-btn" onclick="window.location.href='{{ settings.telegram_url if settings else 'https://t.me/xiaobaolacky' }}'" title="CSKH">
        <!-- Customer service logo (inline SVG, lightweight, always visible) -->
        <svg class="cskh-icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M12 2a7 7 0 0 0-7 7v2a2 2 0 0 0 2 2h1v-4a4 4 0 0 1 8 0v7a3 3 0 0 1-3 3h-2a1 1 0 1 1 0-2h2a1 1 0 0 0 1-1v-1.05A6.98 6.98 0 0 1 5 13H4a4 4 0 0 1-4-4V9a9 9 0 1 1 18 0v1a1 1 0 1 1-2 0V9a7 7 0 0 0-7-7z"/>
        </svg>
    </div>

    <nav class="navbar navbar-dark bg-gradient" style="background: linear-gradient(90deg, var(--primary), #1a1a1a);">
        <div class="container-fluid position-relative">
            {# Centered brand/logo or page title #} {% if page_title %}
            <div class="navbar-brand brand-center fw-bold">{{ page_title }}</div>
            {% elif settings and settings.logo_path %}
            <a class="navbar-brand brand-center" href="/">
                <img src="{{ settings.logo_path }}" alt="{{ settings.site_name }}" class="brand-logo">
            </a>
            {% else %}
            <a class="navbar-brand brand-center fw-bold" href="/">{{ settings.site_name if settings else 'Site' }}</a> {% endif %}
            <div class="ms-auto d-flex align-items-center">
                {% if current_user.is_authenticated %} {% if current_user.is_admin %}
                <a class="btn btn-sm btn-outline-light" href="{{ url_for('admin.dashboard') }}">Quản trị</a> {% endif %} {# Đã xóa hiển thị số dư và nút Đăng xuất khỏi góc phải #} {% else %}
                <a class="btn btn-sm btn-outline-light" href="{{ url_for('auth.login') }}">Đăng nhập</a> {% endif %}
            </div>
        </div>
    </nav>

    <div class="container py-3" style="padding-bottom: 90px;">
        {% with messages = get_flashed_messages(with_categories=true) %} {% if messages %}
        <div class="position-fixed top-0 end-0 p-3" style="z-index: 2000;">
            {% for category, message in messages %}
            <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
        </div>
        {% endif %} {% endwith %} {% block content %}{% endblock %}
    </div>

    {% include 'components/bottom_nav.html' %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script>
        // Global lightweight normalizer: trim trailing zeros in odds badges on any page
        (function() {
            const normalize = () => {
                document.querySelectorAll('.bet-option .badge').forEach(el => {
                    const raw = (el.textContent || '').trim();
                    const num = parseFloat(raw);
                    if (!isNaN(num)) {
                        let s = num.toString();
                        if (/\.\d{3,}$/.test(s)) s = (Math.round(num * 100) / 100).toString();
                        el.textContent = s;
                    }
                });
            };
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', normalize);
            } else {
                normalize();
            }
        })();
    </script>
</body>

</html>